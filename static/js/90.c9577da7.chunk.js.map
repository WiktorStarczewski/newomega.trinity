{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5/ion-virtual-scroll.entry.js"],"names":["createNode","el","type","template","getTemplate","ownerDocument","importNode","content","children","querySelector","calcCells","items","itemHeight","headerHeight","footerHeight","headerFn","footerFn","approxHeaderHeight","approxFooterHeight","approxItemHeight","j","offset","len","cells","end","i","value","item","push","index","height","reads","visible","VirtualScroll","class_1","hostRef","_this","this","range","length","viewportHeight","virtualDom","isEnabled","viewportOffset","currentScrollTop","indexDirty","lastItemLen","totalHeight","onScroll","updateVirtualScroll","prototype","itemsChanged","connectedCallback","contentEl","_a","_b","label","closest","getScrollElement","console","error","scrollEl","sent","updateState","componentDidUpdate","disconnectedCallback","undefined","onResize","positionForItem","Promise","resolve","heightIndex","cell","find","c","positionForIndex","getHeightIndex","checkRange","cellIndex","max","findIndex","findCellIndex","dst","src","inplaceUpdate","Math","scheduleUpdate","checkEnd","timerUpdate","clearTimeout","readVS","bind","writeVS","topOffset","node","offsetTop","parentElement","offsetHeight","scrollTop","dirtyIndex","viewport","vierportHeight","margin","top","bottom","getViewport","buffer","topPos","bottomPos","min","getRange","currentRange","getShouldUpdate","dom","_i","dom_1","change","d","toMutate","_loop_1","n","pool","filter","_loop_2","toMutate_1","forEach","updateVDom","nodeRender","updateCellHeight","child","Array","from","tagName","childrenNu","newChild","classList","add","appendChild","style","transform","remove","doRender","domRender","renderItem","forceUpdate","update","window","getComputedStyle","parseFloat","getPropertyValue","setCellHeight","componentOnReady","then","setTimeout","shouldEnable","enableScrollEvents","Infinity","calcHeightIndex","buf","Uint32Array","newBuf","set","subarray","resizeBuffer","acum","shouldListen","rmEvent","addEventListener","removeEventListener","renderVirtualNode","renderHeader","renderFooter","render","VirtualProxy","map","Object","defineProperty","get","enumerable","configurable","utils","vattrs","classes","class","assign"],"mappings":"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","file":"static/js/90.c9577da7.chunk.js","sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { r as registerInstance, f as readTask, w as writeTask, h, H as Host, e as getElement } from './core-feeeff0d.js';\nimport './config-3c7f3790.js';\nvar CELL_TYPE_ITEM = 'item';\nvar CELL_TYPE_HEADER = 'header';\nvar CELL_TYPE_FOOTER = 'footer';\nvar NODE_CHANGE_NONE = 0;\nvar NODE_CHANGE_POSITION = 1;\nvar NODE_CHANGE_CELL = 2;\nvar MIN_READS = 2;\n\nvar updateVDom = function updateVDom(dom, heightIndex, cells, range) {\n  // reset dom\n  for (var _i = 0, dom_1 = dom; _i < dom_1.length; _i++) {\n    var node = dom_1[_i];\n    node.change = NODE_CHANGE_NONE;\n    node.d = true;\n  } // try to match into exisiting dom\n\n\n  var toMutate = [];\n  var end = range.offset + range.length;\n\n  var _loop_1 = function _loop_1(i) {\n    var cell = cells[i];\n    var node = dom.find(function (n) {\n      return n.d && n.cell === cell;\n    });\n\n    if (node) {\n      var top = heightIndex[i];\n\n      if (top !== node.top) {\n        node.top = top;\n        node.change = NODE_CHANGE_POSITION;\n      }\n\n      node.d = false;\n    } else {\n      toMutate.push(cell);\n    }\n  };\n\n  for (var i = range.offset; i < end; i++) {\n    _loop_1(i);\n  } // needs to append\n\n\n  var pool = dom.filter(function (n) {\n    return n.d;\n  });\n\n  var _loop_2 = function _loop_2(cell) {\n    var node = pool.find(function (n) {\n      return n.d && n.cell.type === cell.type;\n    });\n    var index = cell.i;\n\n    if (node) {\n      node.d = false;\n      node.change = NODE_CHANGE_CELL;\n      node.cell = cell;\n      node.top = heightIndex[index];\n    } else {\n      dom.push({\n        d: false,\n        cell: cell,\n        visible: true,\n        change: NODE_CHANGE_CELL,\n        top: heightIndex[index]\n      });\n    }\n  };\n\n  for (var _a = 0, toMutate_1 = toMutate; _a < toMutate_1.length; _a++) {\n    var cell = toMutate_1[_a];\n\n    _loop_2(cell);\n  }\n\n  dom.filter(function (n) {\n    return n.d && n.top !== -9999;\n  }).forEach(function (n) {\n    n.change = NODE_CHANGE_POSITION;\n    n.top = -9999;\n  });\n};\n\nvar doRender = function doRender(el, nodeRender, dom, updateCellHeight) {\n  var children = Array.from(el.children).filter(function (n) {\n    return n.tagName !== 'TEMPLATE';\n  });\n  var childrenNu = children.length;\n  var child;\n\n  for (var i = 0; i < dom.length; i++) {\n    var node = dom[i];\n    var cell = node.cell; // the cell change, the content must be updated\n\n    if (node.change === NODE_CHANGE_CELL) {\n      if (i < childrenNu) {\n        child = children[i];\n        nodeRender(child, cell, i);\n      } else {\n        var newChild = createNode(el, cell.type);\n        child = nodeRender(newChild, cell, i) || newChild;\n        child.classList.add('virtual-item');\n        el.appendChild(child);\n      }\n\n      child['$ionCell'] = cell;\n    } else {\n      child = children[i];\n    } // only update position when it changes\n\n\n    if (node.change !== NODE_CHANGE_NONE) {\n      child.style.transform = \"translate3d(0,\" + node.top + \"px,0)\";\n    } // update visibility\n\n\n    var visible = cell.visible;\n\n    if (node.visible !== visible) {\n      if (visible) {\n        child.classList.remove('virtual-loading');\n      } else {\n        child.classList.add('virtual-loading');\n      }\n\n      node.visible = visible;\n    } // dynamic height\n\n\n    if (cell.reads > 0) {\n      updateCellHeight(cell, child);\n      cell.reads--;\n    }\n  }\n};\n\nvar createNode = function createNode(el, type) {\n  var template = getTemplate(el, type);\n\n  if (template && el.ownerDocument) {\n    return el.ownerDocument.importNode(template.content, true).children[0];\n  }\n\n  return null;\n};\n\nvar getTemplate = function getTemplate(el, type) {\n  switch (type) {\n    case CELL_TYPE_ITEM:\n      return el.querySelector('template:not([name])');\n\n    case CELL_TYPE_HEADER:\n      return el.querySelector('template[name=header]');\n\n    case CELL_TYPE_FOOTER:\n      return el.querySelector('template[name=footer]');\n  }\n};\n\nvar getViewport = function getViewport(scrollTop, vierportHeight, margin) {\n  return {\n    top: Math.max(scrollTop - margin, 0),\n    bottom: scrollTop + vierportHeight + margin\n  };\n};\n\nvar getRange = function getRange(heightIndex, viewport, buffer) {\n  var topPos = viewport.top;\n  var bottomPos = viewport.bottom; // find top index\n\n  var i = 0;\n\n  for (; i < heightIndex.length; i++) {\n    if (heightIndex[i] > topPos) {\n      break;\n    }\n  }\n\n  var offset = Math.max(i - buffer - 1, 0); // find bottom index\n\n  for (; i < heightIndex.length; i++) {\n    if (heightIndex[i] >= bottomPos) {\n      break;\n    }\n  }\n\n  var end = Math.min(i + buffer, heightIndex.length);\n  var length = end - offset;\n  return {\n    offset: offset,\n    length: length\n  };\n};\n\nvar getShouldUpdate = function getShouldUpdate(dirtyIndex, currentRange, range) {\n  var end = range.offset + range.length;\n  return dirtyIndex <= end || currentRange.offset !== range.offset || currentRange.length !== range.length;\n};\n\nvar findCellIndex = function findCellIndex(cells, index) {\n  var max = cells.length > 0 ? cells[cells.length - 1].index : 0;\n\n  if (index === 0) {\n    return 0;\n  } else if (index === max + 1) {\n    return cells.length;\n  } else {\n    return cells.findIndex(function (c) {\n      return c.index === index;\n    });\n  }\n};\n\nvar inplaceUpdate = function inplaceUpdate(dst, src, offset) {\n  if (offset === 0 && src.length >= dst.length) {\n    return src;\n  }\n\n  for (var i = 0; i < src.length; i++) {\n    dst[i + offset] = src[i];\n  }\n\n  return dst;\n};\n\nvar calcCells = function calcCells(items, itemHeight, headerHeight, footerHeight, headerFn, footerFn, approxHeaderHeight, approxFooterHeight, approxItemHeight, j, offset, len) {\n  var cells = [];\n  var end = len + offset;\n\n  for (var i = offset; i < end; i++) {\n    var item = items[i];\n\n    if (headerFn) {\n      var value = headerFn(item, i, items);\n\n      if (value != null) {\n        cells.push({\n          i: j++,\n          type: CELL_TYPE_HEADER,\n          value: value,\n          index: i,\n          height: headerHeight ? headerHeight(value, i) : approxHeaderHeight,\n          reads: headerHeight ? 0 : MIN_READS,\n          visible: !!headerHeight\n        });\n      }\n    }\n\n    cells.push({\n      i: j++,\n      type: CELL_TYPE_ITEM,\n      value: item,\n      index: i,\n      height: itemHeight ? itemHeight(item, i) : approxItemHeight,\n      reads: itemHeight ? 0 : MIN_READS,\n      visible: !!itemHeight\n    });\n\n    if (footerFn) {\n      var value = footerFn(item, i, items);\n\n      if (value != null) {\n        cells.push({\n          i: j++,\n          type: CELL_TYPE_FOOTER,\n          value: value,\n          index: i,\n          height: footerHeight ? footerHeight(value, i) : approxFooterHeight,\n          reads: footerHeight ? 0 : MIN_READS,\n          visible: !!footerHeight\n        });\n      }\n    }\n  }\n\n  return cells;\n};\n\nvar calcHeightIndex = function calcHeightIndex(buf, cells, index) {\n  var acum = buf[index];\n\n  for (var i = index; i < buf.length; i++) {\n    buf[i] = acum;\n    acum += cells[i].height;\n  }\n\n  return acum;\n};\n\nvar resizeBuffer = function resizeBuffer(buf, len) {\n  if (!buf) {\n    return new Uint32Array(len);\n  }\n\n  if (buf.length === len) {\n    return buf;\n  } else if (len > buf.length) {\n    var newBuf = new Uint32Array(len);\n    newBuf.set(buf);\n    return newBuf;\n  } else {\n    return buf.subarray(0, len);\n  }\n};\n\nvar positionForIndex = function positionForIndex(index, cells, heightIndex) {\n  var cell = cells.find(function (c) {\n    return c.type === CELL_TYPE_ITEM && c.index === index;\n  });\n\n  if (cell) {\n    return heightIndex[cell.i];\n  }\n\n  return -1;\n};\n\nvar VirtualScroll =\n/** @class */\nfunction () {\n  function class_1(hostRef) {\n    var _this = this;\n\n    registerInstance(this, hostRef);\n    this.range = {\n      offset: 0,\n      length: 0\n    };\n    this.viewportHeight = 0;\n    this.cells = [];\n    this.virtualDom = [];\n    this.isEnabled = false;\n    this.viewportOffset = 0;\n    this.currentScrollTop = 0;\n    this.indexDirty = 0;\n    this.lastItemLen = 0;\n    this.totalHeight = 0;\n    /**\n     * It is important to provide this\n     * if virtual item height will be significantly larger than the default\n     * The approximate height of each virtual item template's cell.\n     * This dimension is used to help determine how many cells should\n     * be created when initialized, and to help calculate the height of\n     * the scrollable area. This height value can only use `px` units.\n     * Note that the actual rendered size of each cell comes from the\n     * app's CSS, whereas this approximation is used to help calculate\n     * initial dimensions before the item has been rendered.\n     */\n\n    this.approxItemHeight = 45;\n    /**\n     * The approximate height of each header template's cell.\n     * This dimension is used to help determine how many cells should\n     * be created when initialized, and to help calculate the height of\n     * the scrollable area. This height value can only use `px` units.\n     * Note that the actual rendered size of each cell comes from the\n     * app's CSS, whereas this approximation is used to help calculate\n     * initial dimensions before the item has been rendered.\n     */\n\n    this.approxHeaderHeight = 30;\n    /**\n     * The approximate width of each footer template's cell.\n     * This dimension is used to help determine how many cells should\n     * be created when initialized, and to help calculate the height of\n     * the scrollable area. This height value can only use `px` units.\n     * Note that the actual rendered size of each cell comes from the\n     * app's CSS, whereas this approximation is used to help calculate\n     * initial dimensions before the item has been rendered.\n     */\n\n    this.approxFooterHeight = 30;\n\n    this.onScroll = function () {\n      _this.updateVirtualScroll();\n    };\n  }\n\n  class_1.prototype.itemsChanged = function () {\n    this.calcCells();\n    this.updateVirtualScroll();\n  };\n\n  class_1.prototype.connectedCallback = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var contentEl, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            contentEl = this.el.closest('ion-content');\n\n            if (!contentEl) {\n              console.error('<ion-virtual-scroll> must be used inside an <ion-content>');\n              return [2\n              /*return*/\n              ];\n            }\n\n            _a = this;\n            return [4\n            /*yield*/\n            , contentEl.getScrollElement()];\n\n          case 1:\n            _a.scrollEl = _b.sent();\n            this.contentEl = contentEl;\n            this.calcCells();\n            this.updateState();\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  class_1.prototype.componentDidUpdate = function () {\n    this.updateState();\n  };\n\n  class_1.prototype.disconnectedCallback = function () {\n    this.scrollEl = undefined;\n  };\n\n  class_1.prototype.onResize = function () {\n    this.calcCells();\n    this.updateVirtualScroll();\n  };\n  /**\n   * Returns the position of the virtual item at the given index.\n   */\n\n\n  class_1.prototype.positionForItem = function (index) {\n    return Promise.resolve(positionForIndex(index, this.cells, this.getHeightIndex()));\n  };\n  /**\n   * This method marks a subset of items as dirty, so they can be re-rendered. Items should be marked as\n   * dirty any time the content or their style changes.\n   *\n   * The subset of items to be updated can are specifing by an offset and a length.\n   */\n\n\n  class_1.prototype.checkRange = function (offset, len) {\n    if (len === void 0) {\n      len = -1;\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var length, cellIndex, cells;\n      return __generator(this, function (_a) {\n        // TODO: kind of hacky how we do in-place updated of the cells\n        // array. this part needs a complete refactor\n        if (!this.items) {\n          return [2\n          /*return*/\n          ];\n        }\n\n        length = len === -1 ? this.items.length - offset : len;\n        cellIndex = findCellIndex(this.cells, offset);\n        cells = calcCells(this.items, this.itemHeight, this.headerHeight, this.footerHeight, this.headerFn, this.footerFn, this.approxHeaderHeight, this.approxFooterHeight, this.approxItemHeight, cellIndex, offset, length);\n        this.cells = inplaceUpdate(this.cells, cells, cellIndex);\n        this.lastItemLen = this.items.length;\n        this.indexDirty = Math.max(offset - 1, 0);\n        this.scheduleUpdate();\n        return [2\n        /*return*/\n        ];\n      });\n    });\n  };\n  /**\n   * This method marks the tail the items array as dirty, so they can be re-rendered.\n   *\n   * It's equivalent to calling:\n   *\n   * ```js\n   * virtualScroll.checkRange(lastItemLen);\n   * ```\n   */\n\n\n  class_1.prototype.checkEnd = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        if (this.items) {\n          this.checkRange(this.lastItemLen);\n        }\n\n        return [2\n        /*return*/\n        ];\n      });\n    });\n  };\n\n  class_1.prototype.updateVirtualScroll = function () {\n    // do nothing if virtual-scroll is disabled\n    if (!this.isEnabled || !this.scrollEl) {\n      return;\n    } // unschedule future updates\n\n\n    if (this.timerUpdate) {\n      clearTimeout(this.timerUpdate);\n      this.timerUpdate = undefined;\n    } // schedule DOM operations into the stencil queue\n\n\n    readTask(this.readVS.bind(this));\n    writeTask(this.writeVS.bind(this));\n  };\n\n  class_1.prototype.readVS = function () {\n    var _a = this,\n        contentEl = _a.contentEl,\n        scrollEl = _a.scrollEl,\n        el = _a.el;\n\n    var topOffset = 0;\n    var node = el;\n\n    while (node && node !== contentEl) {\n      topOffset += node.offsetTop;\n      node = node.parentElement;\n    }\n\n    this.viewportOffset = topOffset;\n\n    if (scrollEl) {\n      this.viewportHeight = scrollEl.offsetHeight;\n      this.currentScrollTop = scrollEl.scrollTop;\n    }\n  };\n\n  class_1.prototype.writeVS = function () {\n    var dirtyIndex = this.indexDirty; // get visible viewport\n\n    var scrollTop = this.currentScrollTop - this.viewportOffset;\n    var viewport = getViewport(scrollTop, this.viewportHeight, 100); // compute lazily the height index\n\n    var heightIndex = this.getHeightIndex(); // get array bounds of visible cells base in the viewport\n\n    var range = getRange(heightIndex, viewport, 2); // fast path, do nothing\n\n    var shouldUpdate = getShouldUpdate(dirtyIndex, this.range, range);\n\n    if (!shouldUpdate) {\n      return;\n    }\n\n    this.range = range; // in place mutation of the virtual DOM\n\n    updateVDom(this.virtualDom, heightIndex, this.cells, range); // Write DOM\n    // Different code paths taken depending of the render API used\n\n    if (this.nodeRender) {\n      doRender(this.el, this.nodeRender, this.virtualDom, this.updateCellHeight.bind(this));\n    } else if (this.domRender) {\n      this.domRender(this.virtualDom);\n    } else if (this.renderItem) {\n      this.el.forceUpdate();\n    }\n  };\n\n  class_1.prototype.updateCellHeight = function (cell, node) {\n    var _this = this;\n\n    var update = function update() {\n      if (node['$ionCell'] === cell) {\n        var style = window.getComputedStyle(node);\n        var height = node.offsetHeight + parseFloat(style.getPropertyValue('margin-bottom'));\n\n        _this.setCellHeight(cell, height);\n      }\n    };\n\n    if (node && node.componentOnReady) {\n      node.componentOnReady().then(update);\n    } else {\n      update();\n    }\n  };\n\n  class_1.prototype.setCellHeight = function (cell, height) {\n    var index = cell.i; // the cell might changed since the height update was scheduled\n\n    if (cell !== this.cells[index]) {\n      return;\n    }\n\n    if (cell.height !== height || cell.visible !== true) {\n      cell.visible = true;\n      cell.height = height;\n      this.indexDirty = Math.min(this.indexDirty, index);\n      this.scheduleUpdate();\n    }\n  };\n\n  class_1.prototype.scheduleUpdate = function () {\n    var _this = this;\n\n    clearTimeout(this.timerUpdate);\n    this.timerUpdate = setTimeout(function () {\n      return _this.updateVirtualScroll();\n    }, 100);\n  };\n\n  class_1.prototype.updateState = function () {\n    var shouldEnable = !!(this.scrollEl && this.cells);\n\n    if (shouldEnable !== this.isEnabled) {\n      this.enableScrollEvents(shouldEnable);\n\n      if (shouldEnable) {\n        this.updateVirtualScroll();\n      }\n    }\n  };\n\n  class_1.prototype.calcCells = function () {\n    if (!this.items) {\n      return;\n    }\n\n    this.lastItemLen = this.items.length;\n    this.cells = calcCells(this.items, this.itemHeight, this.headerHeight, this.footerHeight, this.headerFn, this.footerFn, this.approxHeaderHeight, this.approxFooterHeight, this.approxItemHeight, 0, 0, this.lastItemLen);\n    this.indexDirty = 0;\n  };\n\n  class_1.prototype.getHeightIndex = function () {\n    if (this.indexDirty !== Infinity) {\n      this.calcHeightIndex(this.indexDirty);\n    }\n\n    return this.heightIndex;\n  };\n\n  class_1.prototype.calcHeightIndex = function (index) {\n    if (index === void 0) {\n      index = 0;\n    } // TODO: optimize, we don't need to calculate all the cells\n\n\n    this.heightIndex = resizeBuffer(this.heightIndex, this.cells.length);\n    this.totalHeight = calcHeightIndex(this.heightIndex, this.cells, index);\n    this.indexDirty = Infinity;\n  };\n\n  class_1.prototype.enableScrollEvents = function (shouldListen) {\n    var _this = this;\n\n    if (this.rmEvent) {\n      this.rmEvent();\n      this.rmEvent = undefined;\n    }\n\n    var scrollEl = this.scrollEl;\n\n    if (scrollEl) {\n      this.isEnabled = shouldListen;\n      scrollEl.addEventListener('scroll', this.onScroll);\n\n      this.rmEvent = function () {\n        scrollEl.removeEventListener('scroll', _this.onScroll);\n      };\n    }\n  };\n\n  class_1.prototype.renderVirtualNode = function (node) {\n    var _a = node.cell,\n        type = _a.type,\n        value = _a.value,\n        index = _a.index;\n\n    switch (type) {\n      case CELL_TYPE_ITEM:\n        return this.renderItem(value, index);\n\n      case CELL_TYPE_HEADER:\n        return this.renderHeader(value, index);\n\n      case CELL_TYPE_FOOTER:\n        return this.renderFooter(value, index);\n    }\n  };\n\n  class_1.prototype.render = function () {\n    var _this = this;\n\n    return h(Host, {\n      style: {\n        height: this.totalHeight + \"px\"\n      }\n    }, this.renderItem && h(VirtualProxy, {\n      dom: this.virtualDom\n    }, this.virtualDom.map(function (node) {\n      return _this.renderVirtualNode(node);\n    })));\n  };\n\n  Object.defineProperty(class_1.prototype, \"el\", {\n    get: function get() {\n      return getElement(this);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(class_1, \"watchers\", {\n    get: function get() {\n      return {\n        \"itemHeight\": [\"itemsChanged\"],\n        \"headerHeight\": [\"itemsChanged\"],\n        \"footerHeight\": [\"itemsChanged\"],\n        \"items\": [\"itemsChanged\"]\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(class_1, \"style\", {\n    get: function get() {\n      return \"ion-virtual-scroll{display:block;position:relative;width:100%;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}ion-virtual-scroll>.virtual-loading{opacity:0}ion-virtual-scroll>.virtual-item{position:absolute!important;top:0!important;right:0!important;left:0!important;-webkit-transition-duration:0ms;transition-duration:0ms;will-change:transform}\";\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return class_1;\n}();\n\nvar VirtualProxy = function VirtualProxy(_a, children, utils) {\n  var dom = _a.dom;\n  return utils.map(children, function (child, i) {\n    var node = dom[i];\n    var vattrs = child.vattrs || {};\n    var classes = vattrs.class || '';\n    classes += 'virtual-item ';\n\n    if (!node.visible) {\n      classes += 'virtual-loading';\n    }\n\n    return Object.assign(Object.assign({}, child), {\n      vattrs: Object.assign(Object.assign({}, vattrs), {\n        class: classes,\n        style: Object.assign(Object.assign({}, vattrs.style), {\n          transform: \"translate3d(0,\" + node.top + \"px,0)\"\n        })\n      })\n    });\n  });\n};\n\nexport { VirtualScroll as ion_virtual_scroll };"],"sourceRoot":""}